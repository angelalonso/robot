pub mod api {
    use log::{debug, info};
    use actix_web::{web, App, HttpServer, Responder};
    use std::sync::mpsc::Sender;

    #[actix_rt::main]
    pub async fn run(channel: Sender<String>) -> std::io::Result<()> {
        let address = "127.0.0.1:8080";

        std::env::set_var("RUST_LOG", "actix_web=debug");

        info!("Starting API Server at {}", address);
        // Start http server
        HttpServer::new(move || {
            App::new()
                .route("/moves", web::get().to(|| self::get_moves(channel)))
                .route("/moves", web::post().to(self::add_moves))
                .route("/moves/{id}", web::delete().to(self::delete_moves))
                //.route("/moves", web::get().to(self::get_moves))
                //.route("/moves", web::post().to(self::add_moves))
                //.route("/moves/{id}", web::delete().to(self::delete_moves))
        })
        .bind(address.to_string())?
        .run()
        .await
    }

    // curl 127.0.0.1:8080/moves
    #[allow(dead_code)]
    pub async fn get_moves(channel: Sender<String>) -> impl Responder {
        let msg = "GET MOVES".to_string();
        match channel.send(msg){
            Ok(c) => debug!("- Forwarded to brain: {:?} ", c),
            Err(_e) => (),
        };
        format!("hello from get moves")
    }

    // curl -X POST 127.0.0.1:8080/users
    #[allow(dead_code)]
    pub async fn add_moves() -> impl Responder {
        let msg = "ADD MOVES";
        format!("hello from add moves")
    }

    #[allow(dead_code)]
    pub async fn delete_moves() -> impl Responder {
        let msg = "DELETE MOVES";
        format!("hello from delete moves")
    }
}

